@model AutoDealer.Web.Models.Car
@using System.ComponentModel.DataAnnotations

@{
    ViewData["Title"] = "Информация об автомобиле";
}

<div>
    <h1>Информация об автомобиле</h1>
    <div class="carousel-wrap">
        <div class="owl-carousel owl-theme" id="slider">
            @{
                for (int i = 1; i < @Model.CarPhotos?.Count(); i++)
                {
                    string subPath = @Model.GetCarImagesFolderPath();
                    string path = $"/CarImages{subPath}/{@Model.CarPhotos[i]}";

                    //<a href=@path data-lightbox="roadtrip"><img src=@path alt="car's' photo" class="carImg" /></a>
                    <div class="item">
                        <a href=@path data-lightbox="roadtrip" data-title="My caption" id="carImgDetails">
                            <img class="demo cursor carImg" src=@path alt="Picture">
                        </a>
                        @*<img src=@path alt="car's' photo" class="carImg" />*@
                    </div>
                }
            }
        </div>
    </div>
    <div class="cardetailsInfo">
        <div class="title_box">
            <h4><a href="#">@Model.Company?.Title @Model.Model?.Title</a></h4>
            <div class="price">Цена: @Model.Price $</div>
        </div>
        <div>
            <span>год: @Model.ProduceDate</span>
            <span>цвет: @Model.Color?.Title</span>
            <span>@Model.Engine?.Capacity @Model.Engine?.Type?.Title</span>
            <span>@Model.Kilometre km</span>
        </div>
        <p>@Model.Description</p>
        <p>@Model.Settings</p>
        <div>
            @*@{
                var settings = @Model.Settings.GetType().GetProperties().Where(p => p.PropertyType == typeof(bool) && ((bool)p.GetValue(@Model.Settings, null)));
                foreach (var p in settings)
                {
                    <p>@p.Name</p>
                }
            }*@
        </div>
    </div>
</div>
<div class="btn-controls">
    <a asp-action="Index" asp-controller="Car" class="btn btn-outline-primary">назад</a>
    <a class="btn btn-outline-success" onclick="location.href='@Url.Action("Create", "Order", new { carId = Model.Id })'">оформить</a>
</div>

<script>
    $(document).ready(function(){
        console.log('document ready...');
        $('.carImg').click(function(){
            $('.next-slide').hide();
            $('.prev-slide').hide();
        });
        
        lightbox.option({
      		'resizeDuration': 300,
      		'wrapAround': true,
			'imageFadeDuration': 400,
			'fadeDuration': 400,
			'albumLabel': 'Фото %1 из %2'
    	});

        $('body').click(function(){
            if ($("#lightbox").not(":visible")) {
                $('.next-slide').show();
                $('.prev-slide').show();
            }
            else {
                $('.next-slide').hide();
                $('.prev-slide').hide();
            }
        });

        //$('.lbl-close').click(function() {
        //    console.log('clicking close Btn...');
        //});

        //const slider = $("#slider").owlCarousel({
        //    loop:true,
        //    margin:10,
        //    nav:true,
        //    lazyLoad:true,
        //    responsive:{
        //        0:{
        //            items:1
        //        },
        //        600:{
        //            items:3
        //        },
        //        1000:{
        //            items:5
        //        }
        //    }
        //});
        var owl = $('.owl-carousel');
        owl.on('initialize.owl.carousel initialized.owl.carousel ' +
        'initialize.owl.carousel initialize.owl.carousel ' +
        'resize.owl.carousel resized.owl.carousel ' +
        'refresh.owl.carousel refreshed.owl.carousel ' +
        'update.owl.carousel updated.owl.carousel ' +
        'drag.owl.carousel dragged.owl.carousel ' +
        'translate.owl.carousel translated.owl.carousel ' +
        'to.owl.carousel changed.owl.carousel',
        function(e) {
            $('.' + e.type)
            .removeClass('secondary')
            .addClass('success');
            window.setTimeout(function() {
            $('.' + e.type)
                .removeClass('success')
                .addClass('secondary');
            }, 500);
        });
        owl.owlCarousel({
        loop: true,
        nav: true,
        lazyLoad: true,
        margin: 10,
        video: true,
        dots: false,
        navText:["<div class='nav-btn prev-slide'></div>","<div class='nav-btn next-slide'></div>"],
        responsive: {
            0: {
            items: 1
            },
            600: {
            items: 1
            },
            960: {
            items: 1,
            },
            1200: {
            items: 1
            }
        }
        });
    });
</script>


